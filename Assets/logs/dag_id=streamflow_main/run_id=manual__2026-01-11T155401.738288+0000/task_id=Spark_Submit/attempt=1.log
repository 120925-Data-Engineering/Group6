[2026-01-11T15:54:11.475+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: streamflow_main.Spark_Submit manual__2026-01-11T15:54:01.738288+00:00 [queued]>
[2026-01-11T15:54:11.492+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: streamflow_main.Spark_Submit manual__2026-01-11T15:54:01.738288+00:00 [queued]>
[2026-01-11T15:54:11.493+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2026-01-11T15:54:11.513+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): Spark_Submit> on 2026-01-11 15:54:01.738288+00:00
[2026-01-11T15:54:11.519+0000] {standard_task_runner.py:60} INFO - Started process 963 to run task
[2026-01-11T15:54:11.523+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'streamflow_main', 'Spark_Submit', 'manual__2026-01-11T15:54:01.738288+00:00', '--job-id', '10', '--raw', '--subdir', 'DAGS_FOLDER/dag_streamflow.py', '--cfg-path', '/tmp/tmph1xm_nqu']
[2026-01-11T15:54:11.525+0000] {standard_task_runner.py:88} INFO - Job 10: Subtask Spark_Submit
[2026-01-11T15:54:11.593+0000] {task_command.py:423} INFO - Running <TaskInstance: streamflow_main.Spark_Submit manual__2026-01-11T15:54:01.738288+00:00 [running]> on host 139c0fac8954
[2026-01-11T15:54:11.713+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='student' AIRFLOW_CTX_DAG_ID='streamflow_main' AIRFLOW_CTX_TASK_ID='Spark_Submit' AIRFLOW_CTX_EXECUTION_DATE='2026-01-11T15:54:01.738288+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2026-01-11T15:54:01.738288+00:00'
[2026-01-11T15:54:11.715+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2026-01-11T15:54:11.717+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', '\n            spark-submit                 --master spark://spark-master:7077                 /opt/spark-jobs/etl_job.py\n        ']
[2026-01-11T15:54:11.730+0000] {subprocess.py:86} INFO - Output:
[2026-01-11T15:54:11.740+0000] {subprocess.py:93} INFO - /opt/spark/bin/load-spark-env.sh: line 68: ps: command not found
[2026-01-11T15:54:15.128+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkContext: Running Spark version 3.5.0
[2026-01-11T15:54:15.130+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkContext: OS info Linux, 5.15.167.4-microsoft-standard-WSL2, amd64
[2026-01-11T15:54:15.131+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkContext: Java version 17.0.17
[2026-01-11T15:54:15.187+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2026-01-11T15:54:15.281+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceUtils: ==============================================================
[2026-01-11T15:54:15.282+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceUtils: No custom resources configured for spark.driver.
[2026-01-11T15:54:15.283+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceUtils: ==============================================================
[2026-01-11T15:54:15.283+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkContext: Submitted application: ETL_job
[2026-01-11T15:54:15.311+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
[2026-01-11T15:54:15.323+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceProfile: Limiting resource is cpu
[2026-01-11T15:54:15.325+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO ResourceProfileManager: Added ResourceProfile id: 0
[2026-01-11T15:54:15.402+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SecurityManager: Changing view acls to: root
[2026-01-11T15:54:15.403+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SecurityManager: Changing modify acls to: root
[2026-01-11T15:54:15.403+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SecurityManager: Changing view acls groups to:
[2026-01-11T15:54:15.404+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SecurityManager: Changing modify acls groups to:
[2026-01-11T15:54:15.405+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: root; groups with view permissions: EMPTY; users with modify permissions: root; groups with modify permissions: EMPTY
[2026-01-11T15:54:15.640+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO Utils: Successfully started service 'sparkDriver' on port 42423.
[2026-01-11T15:54:15.673+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkEnv: Registering MapOutputTracker
[2026-01-11T15:54:15.713+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkEnv: Registering BlockManagerMaster
[2026-01-11T15:54:15.731+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
[2026-01-11T15:54:15.732+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
[2026-01-11T15:54:15.737+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
[2026-01-11T15:54:15.760+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-b4c43d0e-a231-4b4c-92a6-78515eabf1dd
[2026-01-11T15:54:15.780+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
[2026-01-11T15:54:15.801+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO SparkEnv: Registering OutputCommitCoordinator
[2026-01-11T15:54:15.950+0000] {subprocess.py:93} INFO - 26/01/11 15:54:15 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
[2026-01-11T15:54:16.024+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Utils: Successfully started service 'SparkUI' on port 4040.
[2026-01-11T15:54:16.149+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Executor: Starting executor ID driver on host 139c0fac8954
[2026-01-11T15:54:16.151+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Executor: OS info Linux, 5.15.167.4-microsoft-standard-WSL2, amd64
[2026-01-11T15:54:16.151+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Executor: Java version 17.0.17
[2026-01-11T15:54:16.162+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
[2026-01-11T15:54:16.163+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@4a50de2b for default.
[2026-01-11T15:54:16.189+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 39147.
[2026-01-11T15:54:16.190+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO NettyBlockTransferService: Server created on 139c0fac8954:39147
[2026-01-11T15:54:16.193+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2026-01-11T15:54:16.199+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 139c0fac8954, 39147, None)
[2026-01-11T15:54:16.203+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO BlockManagerMasterEndpoint: Registering block manager 139c0fac8954:39147 with 434.4 MiB RAM, BlockManagerId(driver, 139c0fac8954, 39147, None)
[2026-01-11T15:54:16.206+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 139c0fac8954, 39147, None)
[2026-01-11T15:54:16.208+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 139c0fac8954, 39147, None)
[2026-01-11T15:54:16.759+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
[2026-01-11T15:54:16.767+0000] {subprocess.py:93} INFO - 26/01/11 15:54:16 INFO SharedState: Warehouse path is 'file:/tmp/***tmpkabvtnjc/spark-warehouse'.
[2026-01-11T15:54:17.746+0000] {subprocess.py:93} INFO - 26/01/11 15:54:17 INFO InMemoryFileIndex: It took 53 ms to list leaf files for 1 paths.
[2026-01-11T15:54:17.845+0000] {subprocess.py:93} INFO - 26/01/11 15:54:17 INFO InMemoryFileIndex: It took 19 ms to list leaf files for 1 paths.
[2026-01-11T15:54:23.108+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO FileSourceStrategy: Pushed Filters:
[2026-01-11T15:54:23.122+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO FileSourceStrategy: Post-Scan Filters:
[2026-01-11T15:54:23.428+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 199.2 KiB, free 434.2 MiB)
[2026-01-11T15:54:23.491+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 434.2 MiB)
[2026-01-11T15:54:23.495+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.4 MiB)
[2026-01-11T15:54:23.501+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO SparkContext: Created broadcast 0 from json at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:23.515+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:23.724+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:23.749+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Got job 0 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:23.750+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Final stage: ResultStage 0 (json at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:23.751+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:23.752+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:23.756+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:23.874+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 16.0 KiB, free 434.2 MiB)
[2026-01-11T15:54:23.879+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 7.5 KiB, free 434.1 MiB)
[2026-01-11T15:54:23.880+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 139c0fac8954:39147 (size: 7.5 KiB, free: 434.4 MiB)
[2026-01-11T15:54:23.881+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:23.903+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:23.905+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
[2026-01-11T15:54:23.972+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8250 bytes)
[2026-01-11T15:54:23.993+0000] {subprocess.py:93} INFO - 26/01/11 15:54:23 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
[2026-01-11T15:54:24.160+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/transaction_events_1768146844.354207.json, range: 0-479275, partition values: [empty row]
[2026-01-11T15:54:24.477+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO CodeGenerator: Code generated in 269.571109 ms
[2026-01-11T15:54:24.651+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 3040 bytes result sent to driver
[2026-01-11T15:54:24.665+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 712 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:24.669+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool
[2026-01-11T15:54:24.674+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: ResultStage 0 (json at NativeMethodAccessorImpl.java:0) finished in 0.896 s
[2026-01-11T15:54:24.676+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:24.677+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
[2026-01-11T15:54:24.679+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Job 0 finished: json at NativeMethodAccessorImpl.java:0, took 0.954822 s
[2026-01-11T15:54:24.813+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO InMemoryFileIndex: It took 14 ms to list leaf files for 1 paths.
[2026-01-11T15:54:24.846+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO InMemoryFileIndex: It took 15 ms to list leaf files for 1 paths.
[2026-01-11T15:54:24.906+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO FileSourceStrategy: Pushed Filters:
[2026-01-11T15:54:24.907+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO FileSourceStrategy: Post-Scan Filters:
[2026-01-11T15:54:24.914+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 199.2 KiB, free 434.0 MiB)
[2026-01-11T15:54:24.930+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 433.9 MiB)
[2026-01-11T15:54:24.932+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.3 MiB)
[2026-01-11T15:54:24.933+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO SparkContext: Created broadcast 2 from json at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:24.935+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:24.956+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO SparkContext: Starting job: json at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:24.958+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Got job 1 (json at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:24.959+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Final stage: ResultStage 1 (json at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:24.961+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:24.962+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:24.962+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:24.966+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 16.0 KiB, free 433.9 MiB)
[2026-01-11T15:54:24.970+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 7.5 KiB, free 433.9 MiB)
[2026-01-11T15:54:24.971+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 139c0fac8954:39147 (size: 7.5 KiB, free: 434.3 MiB)
[2026-01-11T15:54:24.971+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:24.973+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[7] at json at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:24.973+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks resource profile 0
[2026-01-11T15:54:24.975+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8244 bytes)
[2026-01-11T15:54:24.976+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
[2026-01-11T15:54:24.987+0000] {subprocess.py:93} INFO - 26/01/11 15:54:24 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/user_events_1768146844.3521993.json, range: 0-163963, partition values: [empty row]
[2026-01-11T15:54:25.062+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 2444 bytes result sent to driver
[2026-01-11T15:54:25.065+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 90 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:25.066+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool
[2026-01-11T15:54:25.067+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: ResultStage 1 (json at NativeMethodAccessorImpl.java:0) finished in 0.103 s
[2026-01-11T15:54:25.067+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:25.068+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
[2026-01-11T15:54:25.069+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Job 1 finished: json at NativeMethodAccessorImpl.java:0, took 0.110707 s
[2026-01-11T15:54:25.609+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO FileSourceStrategy: Pushed Filters: IsNotNull(products),IsNotNull(user_id)
[2026-01-11T15:54:25.611+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO FileSourceStrategy: Post-Scan Filters: (size(products#12, true) > 0),isnotnull(products#12),isnotnull(user_id#21)
[2026-01-11T15:54:25.616+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
[2026-01-11T15:54:25.616+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#58),isnotnull(product_id#53)
[2026-01-11T15:54:25.727+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[2026-01-11T15:54:25.896+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO CodeGenerator: Code generated in 47.055643 ms
[2026-01-11T15:54:25.901+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 199.1 KiB, free 433.7 MiB)
[2026-01-11T15:54:25.913+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 433.7 MiB)
[2026-01-11T15:54:25.915+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.3 MiB)
[2026-01-11T15:54:25.916+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO SparkContext: Created broadcast 4 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:25.920+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:25.955+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:25.956+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Got job 2 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) with 1 output partitions
[2026-01-11T15:54:25.957+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Final stage: ResultStage 2 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264)
[2026-01-11T15:54:25.958+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:25.959+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:25.960+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Submitting ResultStage 2 (MapPartitionsRDD[11] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264), which has no missing parents
[2026-01-11T15:54:25.961+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 20.0 KiB, free 433.7 MiB)
[2026-01-11T15:54:25.970+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 8.3 KiB, free 433.6 MiB)
[2026-01-11T15:54:25.971+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 139c0fac8954:39147 (size: 8.3 KiB, free: 434.3 MiB)
[2026-01-11T15:54:25.973+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:25.974+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 2 (MapPartitionsRDD[11] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:25.975+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO TaskSchedulerImpl: Adding task set 2.0 with 1 tasks resource profile 0
[2026-01-11T15:54:25.976+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 2) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8244 bytes)
[2026-01-11T15:54:25.977+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
[2026-01-11T15:54:25.997+0000] {subprocess.py:93} INFO - 26/01/11 15:54:25 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 139c0fac8954:39147 in memory (size: 7.5 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.009+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO BlockManagerInfo: Removed broadcast_2_piece0 on 139c0fac8954:39147 in memory (size: 34.2 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.026+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 27.018098 ms
[2026-01-11T15:54:26.030+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/user_events_1768146844.3521993.json, range: 0-163963, partition values: [empty row]
[2026-01-11T15:54:26.071+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 25.388186 ms
[2026-01-11T15:54:26.109+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 6.559942 ms
[2026-01-11T15:54:26.120+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 5.359519 ms
[2026-01-11T15:54:26.222+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 22403 bytes result sent to driver
[2026-01-11T15:54:26.226+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 2) in 251 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:26.227+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool
[2026-01-11T15:54:26.228+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: ResultStage 2 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) finished in 0.269 s
[2026-01-11T15:54:26.229+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:26.230+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 2: Stage finished
[2026-01-11T15:54:26.230+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Job 2 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264, took 0.273989 s
[2026-01-11T15:54:26.257+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 7.518795 ms
[2026-01-11T15:54:26.267+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 139c0fac8954:39147 in memory (size: 8.3 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.276+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 1032.0 KiB, free 432.9 MiB)
[2026-01-11T15:54:26.286+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 22.5 KiB, free 432.9 MiB)
[2026-01-11T15:54:26.287+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 139c0fac8954:39147 (size: 22.5 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.289+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO SparkContext: Created broadcast 6 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:26.311+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO FileSourceStrategy: Pushed Filters: IsNotNull(products),IsNotNull(user_id)
[2026-01-11T15:54:26.311+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO FileSourceStrategy: Post-Scan Filters: (size(products#12, true) > 0),isnotnull(products#12),isnotnull(user_id#21)
[2026-01-11T15:54:26.486+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 67.428218 ms
[2026-01-11T15:54:26.491+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 199.1 KiB, free 432.7 MiB)
[2026-01-11T15:54:26.505+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 432.7 MiB)
[2026-01-11T15:54:26.510+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.512+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO SparkContext: Created broadcast 7 from showString at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:26.515+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:26.528+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:26.530+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Got job 3 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:26.533+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Final stage: ResultStage 3 (showString at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:26.538+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:26.540+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:26.543+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[15] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:26.545+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 46.1 KiB, free 432.6 MiB)
[2026-01-11T15:54:26.549+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 15.3 KiB, free 432.6 MiB)
[2026-01-11T15:54:26.552+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 139c0fac8954:39147 (size: 15.3 KiB, free: 434.3 MiB)
[2026-01-11T15:54:26.555+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:26.556+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[15] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:26.558+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
[2026-01-11T15:54:26.561+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8250 bytes)
[2026-01-11T15:54:26.562+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO Executor: Running task 0.0 in stage 3.0 (TID 3)
[2026-01-11T15:54:26.604+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 50.340462 ms
[2026-01-11T15:54:26.606+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/transaction_events_1768146844.354207.json, range: 0-479275, partition values: [empty row]
[2026-01-11T15:54:26.634+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 17.873656 ms
[2026-01-11T15:54:26.644+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 5.947702 ms
[2026-01-11T15:54:26.651+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 3.893639 ms
[2026-01-11T15:54:26.785+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO Executor: Finished task 0.0 in stage 3.0 (TID 3). 12621 bytes result sent to driver
[2026-01-11T15:54:26.789+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 245 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:26.790+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool
[2026-01-11T15:54:26.790+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: ResultStage 3 (showString at NativeMethodAccessorImpl.java:0) finished in 0.259 s
[2026-01-11T15:54:26.791+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:26.792+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
[2026-01-11T15:54:26.793+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO DAGScheduler: Job 3 finished: showString at NativeMethodAccessorImpl.java:0, took 0.262796 s
[2026-01-11T15:54:26.835+0000] {subprocess.py:93} INFO - 26/01/11 15:54:26 INFO CodeGenerator: Code generated in 27.021636 ms
[2026-01-11T15:54:26.899+0000] {subprocess.py:93} INFO - +--------------------+--------+-----------------------+--------------+--------------------+--------------------+---------+--------+------+--------------------+--------+--------------------+----------------+--------+--------------------+-------+--------------------+-------+-------+----------+--------------------+----------------+---------------+--------------+----------+--------+------------+------------+--------------------+--------+
[2026-01-11T15:54:26.900+0000] {subprocess.py:93} INFO - |     billing_address|currency|original_transaction_id|payment_method|            products|    shipping_address|   status|subtotal|   tax|         t_timestamp|   total|      transaction_id|transaction_type| user_id|             product|browser|                city|country| device|element_id|            event_id|      event_type|     ip_address|          page|product_id|quantity|search_query|  session_id|           timestamp| user_id|
[2026-01-11T15:54:26.901+0000] {subprocess.py:93} INFO - +--------------------+--------+-----------------------+--------------+--------------------+--------------------+---------+--------+------+--------------------+--------+--------------------+----------------+--------+--------------------+-------+--------------------+-------+-------+----------+--------------------+----------------+---------------+--------------+----------+--------+------------+------------+--------------------+--------+
[2026-01-11T15:54:26.902+0000] {subprocess.py:93} INFO - |{Lake Jason, LS, ...|     EUR|                   NULL|    debit_card|[{home, PROD_1176...|{Karenchester, LK...|completed| 1084.16| 67.84|2026-01-11T15:53:...|  1152.0|49257af1-b6aa-405...|        purchase|5715bd6f|{home, PROD_1176,...| Chrome|South Christopher...|     PS| tablet|      NULL|b194990b-6961-429...|remove_from_cart|  28.208.129.60|          home| PROD_1176|       5|        NULL|db946570-1ac|2026-01-11T15:53:...|5715bd6f|
[2026-01-11T15:54:26.903+0000] {subprocess.py:93} INFO - |{Tammyburgh, BR, ...|     GBP|                   NULL| bank_transfer|[{home, PROD_1014...|{Meltonfort, VE, ...|completed| 2233.08|206.68|2026-01-11T15:53:...| 2439.76|1d2ae042-042a-4f6...|        purchase|885f6e66|{beauty, PROD_117...| Safari|        West Kristin|     BN| mobile|      NULL|48603b32-b4fb-4eb...|remove_from_cart| 157.14.217.104|          help| PROD_1172|       1|        NULL|085b15fb-4a8|2026-01-11T15:53:...|885f6e66|
[2026-01-11T15:54:26.904+0000] {subprocess.py:93} INFO - |{Johnport, SD, VA...|     EUR|   e13f8740-bd74-4fe...|   credit_card|[{home, PROD_1058...|{South Kennethtow...|completed| 1796.15|160.24|2026-01-11T15:53:...|-1956.39|8a713a73-fdee-4aa...|      chargeback|ff50bde4|{sports, PROD_113...| Safari|        Jenniferland|     CA| mobile|      NULL|489af195-62b6-459...|remove_from_cart|141.234.235.181|          help| PROD_1138|       4|        NULL|3b8ede31-e61|2026-01-11T15:53:...|ff50bde4|
[2026-01-11T15:54:26.905+0000] {subprocess.py:93} INFO - |{Erinstad, VE, ID...|     GBP|                   NULL|   credit_card|[{beauty, PROD_11...|{Port Joshuahaven...|completed| 3989.17|236.72|2026-01-11T15:53:...| 4225.89|02288f07-fbda-45a...|        purchase|aefcfad8|{clothing, PROD_1...|   Edge|   North Williamstad|     TV| tablet|      NULL|ad5cba24-4d59-416...|remove_from_cart|  14.90.188.159|      checkout| PROD_1097|       3|        NULL|4082fcda-758|2026-01-11T15:53:...|aefcfad8|
[2026-01-11T15:54:26.906+0000] {subprocess.py:93} INFO - |{Richardsonfort, ...|     AUD|                   NULL|    google_pay|[{clothing, PROD_...|{East Charlesbury...|completed| 5641.46|535.98|2026-01-11T15:53:...| 6177.44|deba0297-41e1-4f6...|        purchase|01d74256|{clothing, PROD_1...|   Edge|            Leeshire|     JP| mobile|      NULL|07af3b8a-5b9e-45f...|remove_from_cart|  2.145.209.210|       profile| PROD_1002|       2|        NULL|5ce195be-01b|2026-01-11T15:53:...|01d74256|
[2026-01-11T15:54:26.906+0000] {subprocess.py:93} INFO - |{North April, CN,...|     CAD|                   NULL| bank_transfer|[{beauty, PROD_10...|{West Joseside, B...|completed| 4368.32|220.19|2026-01-11T15:53:...| 4588.51|174d65c0-ed60-48d...|        purchase|451b4cf3|{beauty, PROD_102...|   Edge|     East Wayneshire|     SA|desktop|      NULL|62d60e93-6198-4d5...|     add_to_cart|196.155.193.127|          cart| PROD_1020|       3|        NULL|b489d070-791|2026-01-11T15:53:...|451b4cf3|
[2026-01-11T15:54:26.908+0000] {subprocess.py:93} INFO - |{Port Loriport, L...|     EUR|                   NULL|   credit_card|[{books, PROD_105...|{South Donna, MU,...|completed| 3247.76|308.79|2026-01-11T15:53:...| 3556.55|3a6570b5-b972-4ca...|        purchase|beb79919|{home, PROD_1010,...|Firefox|           Marshberg|     SY| mobile|      NULL|440b71a6-fba1-473...|     add_to_cart|   95.76.227.40|      products| PROD_1010|       1|        NULL|7ab3137c-f2c|2026-01-11T15:53:...|beb79919|
[2026-01-11T15:54:26.909+0000] {subprocess.py:93} INFO - |{Davidburgh, BN, ...|     CAD|                   NULL|    google_pay|[{electronics, PR...|{Gonzalezburgh, M...|completed| 2071.74| 144.6|2026-01-11T15:53:...| 2216.34|86b48979-efbb-428...|        purchase|7914c120|{electronics, PRO...| Chrome|           Ayalaberg|     MZ| tablet|      NULL|8c53b74c-0c9f-46e...|     add_to_cart|  37.113.239.32|      settings| PROD_1133|       1|        NULL|79d19c4e-152|2026-01-11T15:53:...|7914c120|
[2026-01-11T15:54:26.910+0000] {subprocess.py:93} INFO - |{Hayesfurt, MM, I...|     GBP|                   NULL|   credit_card|[{home, PROD_1035...|{Patricktown, HR,...|  pending| 3681.24|304.29|2026-01-11T15:53:...| 3985.53|e8ea1605-ea36-4b0...|        purchase|81f631d4|{books, PROD_1189...|Firefox|           Bethshire|     SZ|desktop|      NULL|b4280f0d-1a6c-445...|     add_to_cart|   195.24.15.39|          cart| PROD_1189|       5|        NULL|fb07ee93-0a3|2026-01-11T15:53:...|81f631d4|
[2026-01-11T15:54:26.910+0000] {subprocess.py:93} INFO - |{Flynnberg, NO, H...|     AUD|                   NULL|    debit_card|[{beauty, PROD_10...|{East Kendra, HT,...|completed| 2275.01| 137.8|2026-01-11T15:53:...| 2412.81|02c22093-f459-4b8...|        purchase|885f6e66|{toys, PROD_1030,...| Chrome|    Stephaniechester|     BY| mobile|      NULL|61cb0527-72e5-489...|     add_to_cart|   130.160.8.89|          home| PROD_1030|       3|        NULL|49ee4969-030|2026-01-11T15:53:...|885f6e66|
[2026-01-11T15:54:26.911+0000] {subprocess.py:93} INFO - |{East Tyler, SK, ...|     EUR|                   NULL|   credit_card|[{electronics, PR...|{New Michael, TT,...|completed| 3177.97|200.47|2026-01-11T15:53:...| 3378.44|50942b90-af9c-40d...|        purchase|81f631d4|{electronics, PRO...| Chrome|          Watsonland|     FJ| mobile|      NULL|c7ecfe71-d493-47f...|remove_from_cart| 196.133.218.55|      checkout| PROD_1167|       3|        NULL|1f178f93-23c|2026-01-11T15:53:...|81f631d4|
[2026-01-11T15:54:26.913+0000] {subprocess.py:93} INFO - |{South Dana, NO, ...|     GBP|                   NULL|     apple_pay|[{home, PROD_1124...|{Rodriguezchester...|completed|  5189.1|488.96|2026-01-11T15:53:...| 5678.06|7308f8c8-c68a-42b...|        purchase|885f6e66|{books, PROD_1085...| Chrome|         Kristieberg|     NR| mobile|      NULL|9343e6ea-985a-454...|remove_from_cart| 11.141.169.169|product_detail| PROD_1085|       1|        NULL|f89617fa-649|2026-01-11T15:53:...|885f6e66|
[2026-01-11T15:54:26.914+0000] {subprocess.py:93} INFO - |{Lewisborough, CD...|     GBP|                   NULL|    debit_card|[{clothing, PROD_...|{Glassburgh, EC, ...|   failed| 1987.39|159.86|2026-01-11T15:53:...| 2147.25|e599bd3c-0bb8-4d3...|        purchase|e27a984d|{clothing, PROD_1...|   Edge|     Gonzalesborough|     EC|desktop|      NULL|85609e8a-a7fb-499...|remove_from_cart| 35.173.121.105|          help| PROD_1152|       2|        NULL|fc04ca7a-ee4|2026-01-11T15:53:...|e27a984d|
[2026-01-11T15:54:26.915+0000] {subprocess.py:93} INFO - |{Andrewshire, JM,...|     EUR|                   NULL|        paypal|[{food, PROD_1199...|{Davischester, IS...|completed| 1826.71|128.83|2026-01-11T15:53:...| 1955.54|7e7279ce-cd7f-45f...|        purchase|e27a984d|{home, PROD_1162,...| Safari|          West Randy|     LC| mobile|      NULL|db4862c2-d5ff-4a1...|     add_to_cart| 37.214.110.165|      checkout| PROD_1162|       4|        NULL|9a72083c-b26|2026-01-11T15:53:...|e27a984d|
[2026-01-11T15:54:26.916+0000] {subprocess.py:93} INFO - |{Port Haroldchest...|     CAD|                   NULL| bank_transfer|[{sports, PROD_10...|{Billfort, BE, NH...|completed| 1178.22| 86.41|2026-01-11T15:53:...| 1264.63|66d6089e-ab91-450...|        purchase|dd2467ac|{clothing, PROD_1...| Safari|          Walkerbury|     TG| tablet|      NULL|2dd0622e-266b-42e...|     add_to_cart| 204.72.108.178|      checkout| PROD_1194|       1|        NULL|5d2d904f-78c|2026-01-11T15:53:...|dd2467ac|
[2026-01-11T15:54:26.917+0000] {subprocess.py:93} INFO - |{Ginashire, GQ, A...|     USD|                   NULL|    google_pay|[{home, PROD_1024...|{Murrayfurt, MH, ...|completed| 3473.81|319.53|2026-01-11T15:53:...| 3793.34|002ae6c6-863e-461...|        purchase|98ae4334|{food, PROD_1063,...| Safari|          Bakershire|     UG|desktop|      NULL|df41e335-b9ae-48e...|remove_from_cart| 129.180.150.68|      products| PROD_1063|       2|        NULL|4ec3f970-956|2026-01-11T15:53:...|98ae4334|
[2026-01-11T15:54:26.918+0000] {subprocess.py:93} INFO - |{North Josephside...|     EUR|   8eed8d34-f384-434...|    google_pay|[{clothing, PROD_...|{Lake Amanda, BB,...|  pending| 2917.69|266.56|2026-01-11T15:53:...|-3184.25|3e3707dc-84d9-42e...|          refund|8dcdcd03|{clothing, PROD_1...|   Edge|      North Johnfort|     PH| mobile|      NULL|7c0a5867-fcce-421...|     add_to_cart|  10.91.164.240|      settings| PROD_1138|       4|        NULL|9a690cad-aaa|2026-01-11T15:53:...|8dcdcd03|
[2026-01-11T15:54:26.919+0000] {subprocess.py:93} INFO - |{Jenniferport, MC...|     CAD|                   NULL|    debit_card|[{electronics, PR...|{Reeseshire, HN, ...|completed| 1882.29| 98.29|2026-01-11T15:53:...| 1980.58|fe839021-4b96-495...|        purchase|310c0c00|{electronics, PRO...| Chrome|         Toddborough|     NI| mobile|      NULL|74797b61-2737-4b5...|     add_to_cart| 187.244.188.21|       profile| PROD_1014|       1|        NULL|f5159494-381|2026-01-11T15:53:...|310c0c00|
[2026-01-11T15:54:26.920+0000] {subprocess.py:93} INFO - +--------------------+--------+-----------------------+--------------+--------------------+--------------------+---------+--------+------+--------------------+--------+--------------------+----------------+--------+--------------------+-------+--------------------+-------+-------+----------+--------------------+----------------+---------------+--------------+----------+--------+------------+------------+--------------------+--------+
[2026-01-11T15:54:26.920+0000] {subprocess.py:93} INFO - 
[2026-01-11T15:54:26.922+0000] {subprocess.py:93} INFO - None
[2026-01-11T15:54:27.300+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(products)
[2026-01-11T15:54:27.301+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#21),(size(products#12, true) > 0),isnotnull(products#12)
[2026-01-11T15:54:27.302+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
[2026-01-11T15:54:27.303+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#58),isnotnull(product_id#53)
[2026-01-11T15:54:27.349+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 9.779736 ms
[2026-01-11T15:54:27.352+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 199.1 KiB, free 432.4 MiB)
[2026-01-11T15:54:27.364+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 139c0fac8954:39147 in memory (size: 15.3 KiB, free: 434.3 MiB)
[2026-01-11T15:54:27.369+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 432.4 MiB)
[2026-01-11T15:54:27.371+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.2 MiB)
[2026-01-11T15:54:27.372+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO SparkContext: Created broadcast 9 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:27.374+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:27.390+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO SparkContext: Starting job: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:27.391+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Got job 4 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) with 1 output partitions
[2026-01-11T15:54:27.391+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Final stage: ResultStage 4 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264)
[2026-01-11T15:54:27.392+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:27.393+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:27.393+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[19] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264), which has no missing parents
[2026-01-11T15:54:27.394+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 15.6 KiB, free 432.4 MiB)
[2026-01-11T15:54:27.400+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 7.4 KiB, free 432.4 MiB)
[2026-01-11T15:54:27.401+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 139c0fac8954:39147 (size: 7.4 KiB, free: 434.2 MiB)
[2026-01-11T15:54:27.402+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:27.403+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[19] at $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:27.404+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
[2026-01-11T15:54:27.406+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 4) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8244 bytes)
[2026-01-11T15:54:27.407+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO Executor: Running task 0.0 in stage 4.0 (TID 4)
[2026-01-11T15:54:27.420+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 7.445662 ms
[2026-01-11T15:54:27.422+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/user_events_1768146844.3521993.json, range: 0-163963, partition values: [empty row]
[2026-01-11T15:54:27.432+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 8.855361 ms
[2026-01-11T15:54:27.440+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 4.667637 ms
[2026-01-11T15:54:27.448+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 5.766228 ms
[2026-01-11T15:54:27.511+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO Executor: Finished task 0.0 in stage 4.0 (TID 4). 4556 bytes result sent to driver
[2026-01-11T15:54:27.512+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 4) in 107 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:27.513+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool
[2026-01-11T15:54:27.515+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: ResultStage 4 ($anonfun$withThreadLocalCaptured$1 at FutureTask.java:264) finished in 0.121 s
[2026-01-11T15:54:27.515+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:27.516+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
[2026-01-11T15:54:27.517+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO DAGScheduler: Job 4 finished: $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264, took 0.125106 s
[2026-01-11T15:54:27.525+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO CodeGenerator: Code generated in 5.762427 ms
[2026-01-11T15:54:27.531+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 1032.0 KiB, free 431.4 MiB)
[2026-01-11T15:54:27.534+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 4.7 KiB, free 431.4 MiB)
[2026-01-11T15:54:27.536+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 139c0fac8954:39147 (size: 4.7 KiB, free: 434.2 MiB)
[2026-01-11T15:54:27.537+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO SparkContext: Created broadcast 11 from $anonfun$withThreadLocalCaptured$1 at FutureTask.java:264
[2026-01-11T15:54:27.547+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(products)
[2026-01-11T15:54:27.548+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#21),(size(products#12, true) > 0),isnotnull(products#12)
[2026-01-11T15:54:27.798+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2026-01-11T15:54:27.799+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2026-01-11T15:54:27.801+0000] {subprocess.py:93} INFO - 26/01/11 15:54:27 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
[2026-01-11T15:54:28.029+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO CodeGenerator: Code generated in 70.934096 ms
[2026-01-11T15:54:28.035+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 199.1 KiB, free 431.2 MiB)
[2026-01-11T15:54:28.051+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 431.2 MiB)
[2026-01-11T15:54:28.053+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.2 MiB)
[2026-01-11T15:54:28.054+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO SparkContext: Created broadcast 12 from csv at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:28.056+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:28.084+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:28.087+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Got job 5 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:28.088+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Final stage: ResultStage 5 (csv at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:28.089+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:28.090+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:28.092+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Submitting ResultStage 5 (MapPartitionsRDD[23] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:28.202+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 232.5 KiB, free 430.9 MiB)
[2026-01-11T15:54:28.209+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 82.4 KiB, free 430.9 MiB)
[2026-01-11T15:54:28.211+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 139c0fac8954:39147 (size: 82.4 KiB, free: 434.1 MiB)
[2026-01-11T15:54:28.212+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:28.214+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 5 (MapPartitionsRDD[23] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:28.216+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
[2026-01-11T15:54:28.219+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 5) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8250 bytes)
[2026-01-11T15:54:28.220+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO Executor: Running task 0.0 in stage 5.0 (TID 5)
[2026-01-11T15:54:28.389+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO CodeGenerator: Code generated in 71.614638 ms
[2026-01-11T15:54:28.394+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2026-01-11T15:54:28.396+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2026-01-11T15:54:28.397+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
[2026-01-11T15:54:28.604+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/transaction_events_1768146844.354207.json, range: 0-479275, partition values: [empty row]
[2026-01-11T15:54:28.637+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO CodeGenerator: Code generated in 27.010679 ms
[2026-01-11T15:54:28.649+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO CodeGenerator: Code generated in 6.985805 ms
[2026-01-11T15:54:28.977+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileOutputCommitter: Saved output of task 'attempt_202601111554284878996455809794676_0005_m_000000_5' to file:/opt/spark-data/gold/advertising/_temporary/0/task_202601111554284878996455809794676_0005_m_000000
[2026-01-11T15:54:28.978+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO SparkHadoopMapRedUtil: attempt_202601111554284878996455809794676_0005_m_000000_5: Committed. Elapsed time: 71 ms.
[2026-01-11T15:54:28.987+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO Executor: Finished task 0.0 in stage 5.0 (TID 5). 2893 bytes result sent to driver
[2026-01-11T15:54:28.990+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 5) in 773 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:28.991+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool
[2026-01-11T15:54:28.994+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: ResultStage 5 (csv at NativeMethodAccessorImpl.java:0) finished in 0.902 s
[2026-01-11T15:54:28.995+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:28.996+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
[2026-01-11T15:54:28.997+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO DAGScheduler: Job 5 finished: csv at NativeMethodAccessorImpl.java:0, took 0.909885 s
[2026-01-11T15:54:28.998+0000] {subprocess.py:93} INFO - 26/01/11 15:54:28 INFO FileFormatWriter: Start to commit write Job a2f5fdbf-21d8-4270-b3e0-43e15eb66dda.
[2026-01-11T15:54:29.395+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileFormatWriter: Write Job a2f5fdbf-21d8-4270-b3e0-43e15eb66dda committed. Elapsed time: 397 ms.
[2026-01-11T15:54:29.399+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileFormatWriter: Finished processing stats for write job a2f5fdbf-21d8-4270-b3e0-43e15eb66dda.
[2026-01-11T15:54:29.711+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileSourceStrategy: Pushed Filters:
[2026-01-11T15:54:29.712+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileSourceStrategy: Post-Scan Filters:
[2026-01-11T15:54:29.770+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO CodeGenerator: Code generated in 13.093715 ms
[2026-01-11T15:54:29.775+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 199.1 KiB, free 430.7 MiB)
[2026-01-11T15:54:29.795+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.2 KiB, free 430.6 MiB)
[2026-01-11T15:54:29.796+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 139c0fac8954:39147 (size: 34.2 KiB, free: 434.1 MiB)
[2026-01-11T15:54:29.797+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO SparkContext: Created broadcast 14 from csv at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:29.800+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
[2026-01-11T15:54:29.861+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Registering RDD 27 (csv at NativeMethodAccessorImpl.java:0) as input to shuffle 0
[2026-01-11T15:54:29.867+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Got map stage job 6 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:29.868+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Final stage: ShuffleMapStage 6 (csv at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:29.869+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Parents of final stage: List()
[2026-01-11T15:54:29.870+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:29.874+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Submitting ShuffleMapStage 6 (MapPartitionsRDD[27] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:29.903+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 18.5 KiB, free 430.6 MiB)
[2026-01-11T15:54:29.904+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 8.8 KiB, free 430.6 MiB)
[2026-01-11T15:54:29.904+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 139c0fac8954:39147 (size: 8.8 KiB, free: 434.1 MiB)
[2026-01-11T15:54:29.905+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:29.907+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 6 (MapPartitionsRDD[27] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:29.908+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO TaskSchedulerImpl: Adding task set 6.0 with 1 tasks resource profile 0
[2026-01-11T15:54:29.911+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO TaskSetManager: Starting task 0.0 in stage 6.0 (TID 6) (139c0fac8954, executor driver, partition 0, PROCESS_LOCAL, 8239 bytes)
[2026-01-11T15:54:29.912+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO Executor: Running task 0.0 in stage 6.0 (TID 6)
[2026-01-11T15:54:29.933+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO CodeGenerator: Code generated in 7.209556 ms
[2026-01-11T15:54:29.954+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO CodeGenerator: Code generated in 13.406199 ms
[2026-01-11T15:54:29.967+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO FileScanRDD: Reading File path: file:///opt/spark-data/landing/transaction_events_1768146844.354207.json, range: 0-479275, partition values: [empty row]
[2026-01-11T15:54:29.980+0000] {subprocess.py:93} INFO - 26/01/11 15:54:29 INFO CodeGenerator: Code generated in 9.444785 ms
[2026-01-11T15:54:30.309+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO Executor: Finished task 0.0 in stage 6.0 (TID 6). 2032 bytes result sent to driver
[2026-01-11T15:54:30.312+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO TaskSetManager: Finished task 0.0 in stage 6.0 (TID 6) in 403 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:30.315+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO TaskSchedulerImpl: Removed TaskSet 6.0, whose tasks have all completed, from pool
[2026-01-11T15:54:30.317+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: ShuffleMapStage 6 (csv at NativeMethodAccessorImpl.java:0) finished in 0.438 s
[2026-01-11T15:54:30.318+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: looking for newly runnable stages
[2026-01-11T15:54:30.319+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: running: Set()
[2026-01-11T15:54:30.319+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: waiting: Set()
[2026-01-11T15:54:30.320+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: failed: Set()
[2026-01-11T15:54:30.340+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
[2026-01-11T15:54:30.373+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2026-01-11T15:54:30.374+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2026-01-11T15:54:30.375+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
[2026-01-11T15:54:30.479+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 9.799607 ms
[2026-01-11T15:54:30.493+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 10.569348 ms
[2026-01-11T15:54:30.613+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
[2026-01-11T15:54:30.616+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Got job 7 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
[2026-01-11T15:54:30.617+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Final stage: ResultStage 8 (csv at NativeMethodAccessorImpl.java:0)
[2026-01-11T15:54:30.618+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
[2026-01-11T15:54:30.619+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Missing parents: List()
[2026-01-11T15:54:30.620+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[34] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
[2026-01-11T15:54:30.643+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 244.6 KiB, free 430.4 MiB)
[2026-01-11T15:54:30.646+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 91.6 KiB, free 430.3 MiB)
[2026-01-11T15:54:30.647+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on 139c0fac8954:39147 (size: 91.6 KiB, free: 434.0 MiB)
[2026-01-11T15:54:30.648+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO SparkContext: Created broadcast 16 from broadcast at DAGScheduler.scala:1580
[2026-01-11T15:54:30.649+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[34] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
[2026-01-11T15:54:30.650+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
[2026-01-11T15:54:30.656+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 7) (139c0fac8954, executor driver, partition 0, NODE_LOCAL, 7891 bytes)
[2026-01-11T15:54:30.657+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO Executor: Running task 0.0 in stage 8.0 (TID 7)
[2026-01-11T15:54:30.698+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
[2026-01-11T15:54:30.699+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
[2026-01-11T15:54:30.699+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
[2026-01-11T15:54:30.916+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO ShuffleBlockFetcherIterator: Getting 1 (60.5 KiB) non-empty blocks including 1 (60.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
[2026-01-11T15:54:30.919+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 15 ms
[2026-01-11T15:54:30.934+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 9.530967 ms
[2026-01-11T15:54:30.953+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 12.591811 ms
[2026-01-11T15:54:30.970+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 7.681023 ms
[2026-01-11T15:54:30.998+0000] {subprocess.py:93} INFO - 26/01/11 15:54:30 INFO CodeGenerator: Code generated in 8.763201 ms
[2026-01-11T15:54:31.049+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 5.869794 ms
[2026-01-11T15:54:31.064+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 6.226851 ms
[2026-01-11T15:54:31.071+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 4.914318 ms
[2026-01-11T15:54:31.082+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 6.446242 ms
[2026-01-11T15:54:31.093+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 9.535037 ms
[2026-01-11T15:54:31.107+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 10.859328 ms
[2026-01-11T15:54:31.131+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 13.807397 ms
[2026-01-11T15:54:31.166+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 9.11193 ms
[2026-01-11T15:54:31.189+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 11.525032 ms
[2026-01-11T15:54:31.199+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO CodeGenerator: Code generated in 7.637392 ms
[2026-01-11T15:54:31.342+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO FileOutputCommitter: Saved output of task 'attempt_202601111554301558981012379543135_0008_m_000000_7' to file:/opt/spark-data/gold/transaction_analytics/_temporary/0/task_202601111554301558981012379543135_0008_m_000000
[2026-01-11T15:54:31.342+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO SparkHadoopMapRedUtil: attempt_202601111554301558981012379543135_0008_m_000000_7: Committed. Elapsed time: 66 ms.
[2026-01-11T15:54:31.344+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO Executor: Finished task 0.0 in stage 8.0 (TID 7). 5845 bytes result sent to driver
[2026-01-11T15:54:31.347+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 7) in 694 ms on 139c0fac8954 (executor driver) (1/1)
[2026-01-11T15:54:31.348+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool
[2026-01-11T15:54:31.350+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO DAGScheduler: ResultStage 8 (csv at NativeMethodAccessorImpl.java:0) finished in 0.731 s
[2026-01-11T15:54:31.351+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
[2026-01-11T15:54:31.352+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
[2026-01-11T15:54:31.352+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO DAGScheduler: Job 7 finished: csv at NativeMethodAccessorImpl.java:0, took 0.738333 s
[2026-01-11T15:54:31.353+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO FileFormatWriter: Start to commit write Job 42d46d8d-efae-4404-bd9b-81a8f695a420.
[2026-01-11T15:54:31.705+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO FileFormatWriter: Write Job 42d46d8d-efae-4404-bd9b-81a8f695a420 committed. Elapsed time: 351 ms.
[2026-01-11T15:54:31.705+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO FileFormatWriter: Finished processing stats for write job 42d46d8d-efae-4404-bd9b-81a8f695a420.
[2026-01-11T15:54:31.707+0000] {subprocess.py:93} INFO - Analytics Table with Window Functions created successfully.
[2026-01-11T15:54:31.708+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO SparkContext: SparkContext is stopping with exitCode 0.
[2026-01-11T15:54:31.733+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO SparkUI: Stopped Spark web UI at http://139c0fac8954:4040
[2026-01-11T15:54:31.757+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
[2026-01-11T15:54:31.780+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO MemoryStore: MemoryStore cleared
[2026-01-11T15:54:31.782+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO BlockManager: BlockManager stopped
[2026-01-11T15:54:31.787+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO BlockManagerMaster: BlockManagerMaster stopped
[2026-01-11T15:54:31.791+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
[2026-01-11T15:54:31.806+0000] {subprocess.py:93} INFO - 26/01/11 15:54:31 INFO SparkContext: Successfully stopped SparkContext
[2026-01-11T15:54:32.258+0000] {subprocess.py:93} INFO - 26/01/11 15:54:32 INFO ShutdownHookManager: Shutdown hook called
[2026-01-11T15:54:32.259+0000] {subprocess.py:93} INFO - 26/01/11 15:54:32 INFO ShutdownHookManager: Deleting directory /tmp/spark-c3cca243-570e-4f40-b983-dd2820964f2a
[2026-01-11T15:54:32.264+0000] {subprocess.py:93} INFO - 26/01/11 15:54:32 INFO ShutdownHookManager: Deleting directory /tmp/spark-1a7e5138-8708-4c8c-a956-6705a5a06728/pyspark-4b1be610-ec71-4095-9d85-4c15cba4814b
[2026-01-11T15:54:32.269+0000] {subprocess.py:93} INFO - 26/01/11 15:54:32 INFO ShutdownHookManager: Deleting directory /tmp/spark-1a7e5138-8708-4c8c-a956-6705a5a06728
[2026-01-11T15:54:32.338+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2026-01-11T15:54:32.383+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=streamflow_main, task_id=Spark_Submit, execution_date=20260111T155401, start_date=20260111T155411, end_date=20260111T155432
[2026-01-11T15:54:32.429+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2026-01-11T15:54:32.453+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
